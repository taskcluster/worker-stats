{"version":3,"file":"tasks.js","sources":["@traceur/generated/TemplateParser/3","static/src/store/tasks.js","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/5"],"names":[],"mappings":"AAAA,MAAM,ECIiB,0BAAA,CACA,0BAAA,CAAA,CCLvB,SAAA;;ACAI,KAAA,aAAA;AFEA,KAAA,SAAA,EAAW,SAAA;;;AGFX,kBHOG,SAAM,WAAA,CACC,CAAE;AACZ,QAAA,CAAA,KAAA,EAAa,IAAI,WAAU,CAAC,CAC1B,OAAA,CAAS,SAAA,CAAA,CAAA;AAAA,GAAA;AIVf,GAAC,eAAA,CAAA,WAAA,CAA4B;AJoB3B,cAAA,CAAA,SAAA,CAAW,IAAA;AACT,YAAO,IAAI,QAAO,WAAE,MAAA,CAAQ,OAAA;AACtB,WAAA,IAAA,EAAM,WAAA,CAAA,IAAe,CAAC,kBAAA,CAAA,CAAA,IAAwB,CAAC,IAAA,CAAA;AACnD,WAAA,CAAA,GAAO,WAAE,GAAA,CAAK,SAAA,CAAa;AACzB,YAAA,EAAI,CAAC,QAAA,CAAA,EAAA,CAAa;AAChB,kBAAM,CAAC,GAAI,MAAK,CAAC,uBAAA,CAAA,CAAA;AACjB,kBAAA;AAAA;AAEF,gBAAM,CAAC,QAAA,CAAA,IAAA,CAAA;AAAA,SAAA,CAAA,CAAA;AAAA,OAAA,CAAA,CAAA;AAAA,KAAA;AAKb,eAAA,CAAA,SAAA,CAAY,IAAA;AACV,YAAO,KAAA,CAAA,KAAA,CAAA,UAAqB,CAAC;AAC3B,cAAA,CAAQ,EAAA;AACR,iBAAA,CAAW,qBAAA,EAAuB,KAAA,CAAA,YAAA,EAAoB,UAAA,EAC3C,eAAA,EAAiB,KAAA,CAAA,MAAA,EAAc;AAAA,OAAA,CAAA,CAAA,IAErC,WAAE,MAAA,CAAW;AAClB,cAAO,OAAA,CAAO,CAAA,CAAA;AAAA,OAAA,CAAA,CAAA;AAAA,KAAA;AAIlB,oBAAA,CAAA,SAAA,CAAiB,IAAA,CAAM,MAAA,CAAO,QAAA;;AAC5B,aAAA,EAAU,QAAA,GAAW,KAAA;AAErB,YAAO,IAAI,QAAO,WAAE,MAAA,CAAQ,OAAA;AACtB,WAAA,QAAA;0BACc,CAAC,IAAA,CAAA,CAAA,IAAU,WAAE,IAAA,CAAS;AACpC,cAAA,EAAI,IAAA,CAAK,KAAA,CAAA,CAAQ,OAAO,OAAM,CAAC,IAAA,CAAA;AAC/B,sBAAU,CAAC,OAAA,CAAS,QAAA,CAAA;AAAA,WAAA,CAAA,CAAA,CAAA,MACd,EAAC,MAAA,CAAA;AAAA,SAAA,CAAA;AAGX,eAAO,CAAA,CAAA;AAAA,OAAA,CAAA,CAAA;AAAA;AAAA,GAAA;AKvDb;ACAA,oBAAwB;AAAE;;ACA1B,sBAAA,CAAoB;AAAA,GAAA;AAAA,CAAA,CAAA","sourcesContent":["define($__placeholder__0, $__placeholder__1);","/*jshint esnext: true */\n\nvar AUTH_URL = '/azure';\n\nmodule AzureTable from '../../vendor/azure_table';\nmodule superagent from '../../vendor/superagent';\n\nexport class TasksStore {\n  constructor() {\n    this.azure = new AzureTable({\n      signUrl: AUTH_URL\n    });\n  }\n\n  /**\n  POST a task to the server.\n\n  @param {Object} task to submit to the server.\n  @return Promise\n  */\n  createTask(task) {\n    return new Promise((accept, reject) => {\n      var req = superagent.post('/task/aws-docker').send(task);\n      req.end((err, response) => {\n        if (!response.ok) {\n          reject(new Error('could not create task'));\n          return;\n        }\n        accept(response.body);\n      });\n    });\n  }\n\n  refreshTask(task) {\n    return this.azure.buildQuery({\n      '$top': 1,\n      '$filter': \"(PartitionKey eq '\" + task.PartitionKey + \"') and \" +\n                 \"(RowKey eq '\" + task.RowKey + \"')\"\n\n    }).then((values) => {\n      return values[0];\n    });\n  }\n\n  refreshTaskUntil(task, field, timeout) {\n    timeout = timeout || 1000;\n\n    return new Promise((accept, reject) => {\n      var refresh = () => {\n        this.refreshTask(task).then((task) => {\n          if (task[field]) return accept(task);\n          setTimeout(refresh, timeout);\n        }).catch(reject);\n      };\n\n      refresh();\n    });\n  }\n}\n","function($__placeholder__0) {\n      $__placeholder__1\n    }","var __moduleName = $__placeholder__0;","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2)","return $__placeholder__0","get $__placeholder__0() { return $__placeholder__1; }","__transpiledModule: true"]}